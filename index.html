<html>
<head>
<title>クアンタムタロットカード</title>
<link rel="shortcut icon" href="favicon.ico">
<style>
body{
  margin: 0px;
  padding: 0px;
  overflow: hidden;
  background-color: #ccb7e0;
}
#content{
  margin: 0px;
  padding: 0px;
  position: relative;
}
#content img{
  margin: 0px;
  padding: 0px;
  cursor: pointer;
  position: absolute;
}
</style>
</head>
<body>
  <div id="content"></div>
</body>
<script>
const CONTENT_OBJ = document.getElementById('content');
const QUANTUM_CARD_DIR = 'img/quantum/';
const QUANTUM_CARD_BACK_COVER_FILE = 'img/99.jpg';
const QUANTUM_CARD_LIST = [
  {
    name: '',
    commentary: '',
    face_up_file_name: '1.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '2.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '3.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '4.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '5.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '6.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '7.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '8.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '9.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '10.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '11.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '12.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '13.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '14.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '15.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '16.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '17.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '18.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '19.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '20.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '21.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '22.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '23.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '24.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '25.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '26.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '27.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '28.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '29.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '30.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '31.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '32.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '33.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '34.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '35.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '36.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '37.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '38.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '39.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '40.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '41.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '42.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '43.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '44.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '45.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '46.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '47.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '48.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '49.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '50.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '51.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '52.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '53.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '54.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '55.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '56.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '57.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '58.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '59.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '60.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '61.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '62.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '63.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '64.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '65.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '66.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '67.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '68.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '69.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '70.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '71.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '72.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '73.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '74.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '75.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '76.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '77.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '78.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '79.jpg',
    img_elm: document.createElement('img'),
  },
  {
    name: '',
    commentary: '',
    face_up_file_name: '80.jpg',
    img_elm: document.createElement('img'),
  }
];
//console.log(QUANTUM_CARD_LIST);
let centerX = 0;//中心座標x
let centerY = 0;//中心座標y
let scaleRatio = 1.0; //拡大縮小率
let isMouseDown = false;//canvas ドラッグ中フラグ
let startMouseDownX = 0;//canvas ドラッグ開始位置X
let startMouseDownY = 0;//canvas 
let startObjDownLeft = 0;//対象オブジェクトleft
let startObjDownTop = 0;//対象オブジェクトtop
let zIndexCount = 1;

let windowWidth = document.body.scrollWidth;
let windowHeight = document.body.scrollHeight;

console.log('windowWidth', windowWidth);
console.log('windowHeight', windowHeight);

console.log('randomWindowWidth', getRandomIntInclusive(0, windowWidth));
console.log('randomWindowHeight', getRandomIntInclusive(0, windowHeight));

console.log('randomWindow', getRandomIntInclusive(0, 1));

//設定
QUANTUM_CARD_LIST.forEach((value, index)=>{
  //表面の画像を設定
  //value.img_elm.src = QUANTUM_CARD_DIR + value.face_up_file_name;
  //value.img_elm.width = 100;
  
  //裏面の画像を設定
  //value.img_elm.src = QUANTUM_CARD_BACK_COVER_FILE;
  //value.img_elm.width = 100;
  
  //画像を設定
  value.img_elm.src = QUANTUM_CARD_BACK_COVER_FILE;
  value.img_elm.width = 100;
  
  
  //表示処理
  //let top = 0;
  //let left = index * value.img_elm.width;
  let top = getRandomIntInclusive(0, Math.round(windowHeight / 2));
  let left = getRandomIntInclusive(0, Math.round(windowWidth / 2));
  value.img_elm.style.top = top+'px';
  value.img_elm.style.left = left+'px';
  
  let rotate = 0;
  if(getRandomIntInclusive(0, 1) == 1){
    rotate = 180;
    //value.img_elm.src = QUANTUM_CARD_DIR + value.face_up_file_name;
  }
  value.img_elm.style.transform = 'rotate('+rotate+'deg)';
  
  CONTENT_OBJ.appendChild(value.img_elm);
  
  //ドラッグ
  value.img_elm.ontouchstart = value.img_elm.onmousedown = function(_e){
    //console.log(_e);
    //console.log(this.src);
    //console.log(value.face_up_file_name);
    
    //checkDoubletap();
    
    //クリック状態フラグ
    isMouseDown = true;
    
    let eventInfo = getEventInfo(_e);
    //console.log(eventInfo);
    
    startMouseDownX = eventInfo.pageX;
    startMouseDownY = eventInfo.pageY;
    
    startObjDownLeft = parseInt(value.img_elm.style.left.replace('px', ''));
    startObjDownTop = parseInt(value.img_elm.style.top.replace('px', ''));
    
    value.img_elm.style.zIndex = zIndexCount;
    zIndexCount++;
    
    console.log('startObjDownLeft', startObjDownLeft);
    console.log('startObjDownTop', startObjDownTop);
    
    if(checkDoubletap()){
      if(this.src.indexOf(QUANTUM_CARD_BACK_COVER_FILE) != -1){
        value.img_elm.src = QUANTUM_CARD_DIR + value.face_up_file_name;
      }else{
        value.img_elm.src = QUANTUM_CARD_BACK_COVER_FILE;
      }
    }
    
    return false;
  }
  
  //ドラッグ終了
  value.img_elm.ontouchend = value.img_elm.onmouseout = value.img_elm.onmouseup = function(_e){
    if(isMouseDown === true){
      isMouseDown = false;
      let eventInfo = getEventInfo(_e);
      //drawCanvas(centerX += (startMouseDownX - eventInfo.pageX) / scaleRatio, centerY += (startMouseDownY - eventInfo.pageY) / scaleRatio);
      //centerX += (startMouseDownX - eventInfo.pageX) / scaleRatio;
      //centerY += (startMouseDownY - eventInfo.pageY) / scaleRatio;
      
      //startObjDownLeft = parseInt(value.img_elm.style.left.replace('px', ''));
      //startObjDownTop = parseInt(value.img_elm.style.top.replace('px', ''));
      
      let x = startObjDownLeft - (startMouseDownX - eventInfo.pageX);
      let y = startObjDownTop - (startMouseDownY - eventInfo.pageY);
      
      console.log('ontouchend x', x);
      console.log('ontouchend y', y);
      
      value.img_elm.style.top = y+'px';
      value.img_elm.style.left = x+'px';
      
      return false;
    }
  }
  
  //ドラッグ中
  value.img_elm.ontouchmove = value.img_elm.onmousemove = function(_e){
    if(isMouseDown === true){
      let eventInfo = getEventInfo(_e);
      //drawCanvas(centerX + (startMouseDownX - eventInfo.pageX) / scaleRatio, centerY + (startMouseDownY - eventInfo.pageY) / scaleRatio);
      //centerX + (startMouseDownX - eventInfo.pageX) / scaleRatio;
      //centerY + (startMouseDownY - eventInfo.pageY) / scaleRatio;
      
      //startObjDownLeft = parseInt(value.img_elm.style.left.replace('px', ''));
      //startObjDownTop = parseInt(value.img_elm.style.top.replace('px', ''));
      
      let x = startObjDownLeft - (startMouseDownX - eventInfo.pageX);
      let y = startObjDownTop - (startMouseDownY - eventInfo.pageY);
      
      console.log('ontouchmove x', x);
      console.log('ontouchmove y', y);
      
      value.img_elm.style.top = y+'px';
      value.img_elm.style.left = x+'px';
      
      return false;
    }
  }
});

//ダブルタップ判定関数
var double_tap_count = 0;
function checkDoubletap(){
  if(!double_tap_count){
    //console.log('if', double_tap_count);
    double_tap_count++;
    //console.log('if', double_tap_count);
    
    //設定したミリ秒以内にタップされない場合はカウンターを0にする
    setTimeout(function () {
      //console.log('setTimeout', double_tap_count);
      //console.log('setTimeout', true);
      double_tap_count = 0;
      return false;
    }, 200);
  }else{
    //設定したミリ秒以内に2回目のタップがされればダブルタップと判定
    //console.log('else', double_tap_count);
    //console.log('else', false);
    double_tap_count = 0;
    return true;
  }
}


//座標取得関数
function getEventInfo(_e){
    let dt = {
        pageX:0,
        pageY:0
    };
    
    if(typeof _e.pageX === 'undefined'){
        dt.pageX = _e.changedTouches[0].pageX;
        dt.pageY = _e.changedTouches[0].pageY;
    }else{
        dt.pageX = _e.pageX;
        dt.pageY = _e.pageY;
    }
    
    return dt;
}

//乱数取得関数
function getRandomInt(max){
  return Math.floor(Math.random() * max);
}

//2つの値の間のランダムな整数を取得
function getRandomIntInclusive(min, max){
  min = Math.ceil(min);
  max = Math.floor(max);
  return Math.floor(Math.random() * (max - min + 1) + min); //The maximum is inclusive and the minimum is inclusive
}

//QUANTUM_CARD_LIST.forEach(element=>{
//  CONTENT_OBJ.appendChild(element.img_elm);
//});
</script>
</html>